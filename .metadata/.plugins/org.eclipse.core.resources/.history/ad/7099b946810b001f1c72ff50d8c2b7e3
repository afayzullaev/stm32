#include "app_main.hpp"
#include "gpio.hpp"

void EXTI15_10_IRQHandler(void) {
    // Your interrupt handling code here
    // This function will be called when the button is pressed
    // Clear the interrupt flag for pin D15
    EXTI->PR |= EXTI_PR_PR15;
}


void app_main(void)
{
	Gpio userBtn(PIN_0, GPIOA, INPUT, NO_PULL);
	userBtn.AttachInterupt(RISING);
	Gpio greenLed(PIN_12, GPIOD, OUTPUT);
	Gpio redLed(PIN_13, GPIOD, OUTPUT);
	Gpio blueLed(PIN_14, GPIOD, OUTPUT);
	Gpio yellowLed(PIN_15, GPIOD, OUTPUT);
	PIN_STATE state;
	while(true)
	{
		state = userBtn.Read();
		if(state == HIGH)
		{
			greenLed.Write(HIGH);
			redLed.Write(HIGH);
			blueLed.Write(HIGH);
			yellowLed.Write(HIGH);
		}else{
			greenLed.Write(LOW);
			redLed.Write(LOW);
			blueLed.Write(LOW);
			yellowLed.Write(LOW);
		}
	}
}
